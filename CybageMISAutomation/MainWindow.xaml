<Window x:Class="CybageMISAutomation.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:wv2="clr-namespace:Microsoft.Web.WebView2.Wpf;assembly=Microsoft.Web.WebView2.Wpf"
        Title="Cybage MIS Report Automation" Height="900" Width="1400"
        WindowStartupLocation="CenterScreen"
        Icon="cybageLogo.png"
        Closing="Window_Closing">
    
    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="200"/>
        </Grid.RowDefinitions>
        
        <!-- Header with Logo -->
        <DockPanel Grid.Row="0" Margin="10" Background="#E3F2FD">
            <Border Background="#BBDEFB" 
                    CornerRadius="8" 
                    Padding="8,4" 
                    Margin="5"
                    DockPanel.Dock="Left">
                <Image Source="cybageLogo.png" 
                       Width="120" Height="40" 
                       Stretch="Uniform"
                       HorizontalAlignment="Left" 
                       VerticalAlignment="Center"/>
            </Border>
            <TextBlock Text="Cybage MIS Report Automation" 
                       FontSize="18" 
                       FontWeight="SemiBold" 
                       Foreground="#1565C0"
                       VerticalAlignment="Center" 
                       Margin="15,0,0,0"/>
        </DockPanel>
        
        <!-- Control Panel -->
        <GroupBox Header="Report Controls" Grid.Row="1" Margin="10">
            <StackPanel Margin="10">
                <!-- First Row: Basic Controls -->
                <StackPanel Orientation="Horizontal" Margin="0,0,0,10">
                    <Label Content="Employee ID:" VerticalAlignment="Center"/>
                    <TextBox x:Name="txtEmployeeId" Width="100" Margin="5" VerticalAlignment="Center" 
                             Text="" ToolTip="Enter Employee ID (loaded from config.json)"/>
                    
                    <!-- Manual Mode controls removed for cleaner UI -->
                    
                    <CheckBox x:Name="chkShowLogs" Content="Show Log Window" 
                              VerticalAlignment="Center" Margin="20,0,0,0" 
                              Checked="ChkShowLogs_Checked" Unchecked="ChkShowLogs_Unchecked"/>
                              
                    <CheckBox x:Name="chkAutoStartFullReport" Content="Auto Start Full Report" 
                              VerticalAlignment="Center" Margin="20,0,0,0" 
                              Checked="ChkAutoStartFullReport_Checked" Unchecked="ChkAutoStartFullReport_Unchecked"
                              ToolTip="Automatically run full calendar report when application starts"/>
                    
            <Button x:Name="btnStartFullAutomation" Content="Today/Yesterday Report" 
                            Width="150" Height="35" Margin="30,0,0,0"
                            Click="BtnFullAutomation_Click" IsEnabled="False"
                            Background="#FF6B8E23" Foreground="White" FontWeight="Bold"/>
                    
                    <Button x:Name="btnReset" Content="ðŸ”„ Reset" 
                            Width="80" Height="30" Margin="20,0,0,0"
                            Click="BtnReset_Click" IsEnabled="True"/>
                    
                    <Button x:Name="btnMonthlyReport" Content="ðŸ“… Monthly Report" 
                            Width="130" Height="35" Margin="20,0,0,0"
                            Click="BtnMonthlyReport_Click" IsEnabled="False"
                            Background="#FF4682B4" Foreground="White" FontWeight="Bold"/>
                    <Button x:Name="btnFullReport" Content="ï¿½ Full Calendar Report"
                            Width="160" Height="40" Margin="20,0,0,0"
                            Click="BtnFullReport_Click" IsEnabled="True"
                            Background="#FF228B22" Foreground="White" FontWeight="Bold" FontSize="14"
                            ToolTip="Generate comprehensive monthly calendar with today/yesterday data"/>
                </StackPanel>
                
                <!-- Second Row: Manual Controls (Hidden by default) -->
                <StackPanel x:Name="pnlManualControls" Orientation="Horizontal" Visibility="Collapsed">
                    <Label Content="Report Type:" VerticalAlignment="Center"/>
                    <ComboBox x:Name="cmbReportType" Width="100" Margin="5" VerticalAlignment="Center">
                        <ComboBoxItem Content="Today" IsSelected="True" Tag="1"/>
                        <ComboBoxItem Content="Yesterday" Tag="0"/>
                    </ComboBox>
                    
                    <Button x:Name="btnStartAutomation" Content="Start Automation" 
                            Width="120" Height="30" Margin="10,5,5,5"
                            Click="BtnStartAutomation_Click" IsEnabled="False"/>
                    
                    <Button x:Name="btnTestPage" Content="Test Page" 
                            Width="100" Height="30" Margin="5"
                            Click="BtnTestPage_Click" IsEnabled="False"/>
                    
                    <Button x:Name="btnShowLogs" Content="Show Logs" 
                            Width="90" Height="30" Margin="5"
                            Click="BtnShowLogs_Click"/>
                    
                    <Button x:Name="btnExpandTree" Content="Expand Tree" 
                            Width="100" Height="30" Margin="5"
                            Click="BtnExpandTree_Click" IsEnabled="False"/>
                    
                    <Button x:Name="btnClickSwipeLog" Content="Click Swipe Log" 
                            Width="110" Height="30" Margin="5"
                            Click="BtnClickSwipeLog_Click" IsEnabled="False"/>
                    
                    <Button x:Name="btnGenerateReport" Content="Generate Report" 
                            Width="120" Height="30" Margin="5"
                            Click="BtnGenerateReport_Click" IsEnabled="False"/>
                    
                    <Button x:Name="btnExtractData" Content="ðŸ“Š Extract Data" 
                            Width="120" Height="30" Margin="5"
                            Click="BtnExtractData_Click" IsEnabled="False"/>
                </StackPanel>
            </StackPanel>
        </GroupBox>
        
        <!-- Status Panel -->
        <GroupBox Header="Status" Grid.Row="2" Margin="10,0,10,10">
            <StackPanel Margin="10">
                <TextBlock x:Name="txtStatus" Text="Initializing WebView2..." 
                          Foreground="Blue" FontWeight="Bold"/>
                <ProgressBar x:Name="progressBar" Height="20" Margin="0,5,0,0" 
                            Minimum="0" Maximum="100" Value="0"/>
            </StackPanel>
        </GroupBox>
        
        <!-- WebView2 -->
        <GroupBox Header="Web Browser" Grid.Row="3" Margin="10,0,10,10">
            <wv2:WebView2 x:Name="webView" Margin="5"/>
        </GroupBox>
        
        <!-- Data Grid 
        <GroupBox Header="Extracted Swipe Data" Grid.Row="4" Margin="10,5,10,10">
            <DataGrid x:Name="dataGridResults" Margin="5" AutoGenerateColumns="True" 
                     IsReadOnly="True" AlternatingRowBackground="LightGray"/>
        </GroupBox>-->
    </Grid>
</Window>